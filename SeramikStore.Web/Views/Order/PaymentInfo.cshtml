@using Microsoft.Extensions.Localization
@using SeramikStore.Web.Localization
@using SeramikStore.Web.ViewModels
@using System.Globalization
@model OrderPaymentInfoViewModel
@inject IStringLocalizer<CartResource> L

@{
    ViewData["Title"] = L["Ödeme Bilgilendirme"];
    var culture = CultureInfo.CurrentCulture;
    var araToplam = Model.TotalAmount;
    var kargo = Model.CargoAmount;
    var toplam = Model.GrandTotal;
    var CurrencyCode = Model.CurrencyCode.ToString().ToUpper();
}

<div class="container mt-4">
    <div class="row">

        <!-- SOL TARAF (GENİŞ) -->
        <div class="col-md-8">

            <!-- TESLİMAT ADRESİ -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="mb-3">
                        <i class="fa-solid fa-truck me-2"></i>
                        @L["Teslimat Adresi"]
                    </h5>

                    <div class="border rounded-3 p-3 bg-light">
                        <strong>@Model.Address.Ad @Model.Address.Soyad</strong><br />
                        @Model.Address.Adres<br />
                        @Model.Address.Ilce / @Model.Address.Il<br />
                        @Model.Address.Telefon
                    </div>
                </div>
            </div>

            <!-- SİPARİŞ LİSTESİ -->
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="mb-3">
                        <i class="fa-solid fa-cart-shopping me-2"></i>
                        @L["Sipariş Özeti"]
                    </h5>

                    <div class="table-responsive">
                        <table class="table align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th>@L["Ürün"]</th>
                                    <th class="text-end">@L["Fiyat"]</th>
                                    <th class="text-center">@L["Adet"]</th>
                                    <th class="text-end">@L["Tutar"]</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Items)
                                {
                                    <tr>
                                        <td class="fw-semibold">
                                            @item.ProductName
                                        </td>
                                        <td class="text-end">
                                            @item.UnitPrice.ToString("N2", culture) @item.CurrencyCode.ToUpper()
                                        </td>
                                        <td class="text-center">
                                            @item.Quantity
                                        </td>
                                        <td class="text-end fw-bold">
                                            @item.LineTotal.ToString("N2", culture) @item.CurrencyCode.ToUpper()
                                        </td>
                                    </tr>
                                }
                                <tr>
                                    <th></th>
                                    <th class="text-end"></th>
                                    <th class="text-center"></th>
                                    <th class="text-end">@araToplam.ToString("N2", culture)  @CurrencyCode.ToUpper()</th>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>


        <!-- SAĞ TARAF (DAR) -->
        <div class="col-md-4">

            <!-- TOPLAM KARTI -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">

                    <h5 class="mb-3">
                        <i class="fa-solid fa-receipt me-2"></i>
                        @L["Ödeme Özeti"]
                    </h5>

                    <div class="d-flex justify-content-between mb-2">
                        <span>@L["Ürün Toplamı"]</span>
                        <span>@araToplam @CurrencyCode</span>
                    </div>

                    <div class="d-flex justify-content-between mb-2">
                        <span>@L["Kargo"]</span>
                        <span>@kargo @CurrencyCode</span>
                    </div>

                    <hr />

                    <div class="d-flex justify-content-between fw-bold fs-5">
                        <span>@L["Genel Toplam"]</span>
                        <span>@toplam @CurrencyCode</span>
                    </div>

                </div>
            </div>


            <!-- BANKA BİLGİSİ -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="mb-3">
                        <i class="fa-solid fa-building-columns me-2"></i>
                        @L["Banka Havalesi Bilgileri"]
                    </h5>

                    <div class="alert alert-info mb-0">
                        <strong>@L["Banka"]:</strong> @Model.BankName <br />
                        <strong>IBAN:</strong> @Model.Iban <br /><br />
                        @L["Açıklama kısmına Sipariş Numaranızı yazmayı unutmayınız."]
                    </div>
                </div>
            </div>


            <!-- SİPARİŞ OLUŞTUR -->
            <form asp-action="CreateOrder" method="post">
                <input type="hidden" name="AddressId" value="@Model.Address.Id" />
                <input type="hidden" name="CargoAmount" value="@Model.CargoAmount" />

                <button type="submit" class="btn btn-success w-100">
                    <i class="fa-solid fa-check me-2"></i>
                    @L["Siparişi Oluştur"]
                </button>
            </form>

        </div>

    </div>
</div>
