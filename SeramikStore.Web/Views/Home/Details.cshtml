@model SeramikStore.Web.ViewModels.ProductDetail

<div class="container mt-4">
    <div class="row">

        <!-- SOL: IMAGE GALERİ -->
        <div class="col-md-6">

            <!-- ANA RESİM -->
            <div class="position-relative text-center">
                <img id="mainImage"
                     src="@(Model.ImagePaths?.FirstOrDefault() ?? "/images/no-image.png")"
                     class="img-fluid img-thumbnail mb-3"
                     style="max-height:450px;" />

                <!-- SOL OK -->
                <button type="button"
                        class="btn btn-light position-absolute top-50 start-0 translate-middle-y"
                        onclick="prevImage()">
                    ❮
                </button>

                <!-- SAĞ OK -->
                <button type="button"
                        class="btn btn-light position-absolute top-50 end-0 translate-middle-y"
                        onclick="nextImage()">
                    ❯
                </button>
            </div>

            <!-- THUMBNAIL RULO -->
            <div class="d-flex justify-content-center gap-2 flex-wrap">
                @for (int i = 0; i < Model.ImagePaths.Count; i++)
                {
                    <img src="@Model.ImagePaths[i]"
                         class="img-thumbnail thumb-img"
                         style="width:80px; height:80px; cursor:pointer"
                         onclick="setImage(@i)" />
                }
            </div>
        </div>

        <!-- SAĞ: ÜRÜN BİLGİLERİ -->
        <div class="col-md-6">
            <h3>@Model.ProductName</h3>
            <p>@Model.ProductDesc</p>

            <h4 class="text-danger">
                @Model.UnitPrice.ToString("N2", new System.Globalization.CultureInfo("tr-TR"))
                @Model.Currency
            </h4>

            <form asp-action="Cart" method="post" class="mt-3">
                <input type="hidden" asp-for="Id" />

                <div class="mb-2">
                    <label>Adet</label>
                    <input asp-for="Quantity" class="form-control w-25" />
                </div>

                <button type="submit" class="btn btn-primary mt-2">
                    Sepete Ekle
                </button>
            </form>
        </div>
    </div>
</div>

<!-- JS -->
<script>
    const images = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.ImagePaths));
    let currentIndex = 0;

    function setImage(index) {
        currentIndex = index;
        document.getElementById("mainImage").src = images[index];
    }

    function prevImage() {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        setImage(currentIndex);
    }

    function nextImage() {
        currentIndex = (currentIndex + 1) % images.length;
        setImage(currentIndex);
    }
</script>
