@model SeramikStore.Web.ViewModels.ProductDetail

<div class="container mt-4">
    <div class="row g-4">

        <!-- SOL: IMAGE GALERİ -->
        <div class="col-md-6">
            <div class="border rounded p-3 bg-white">
                <!-- ANA RESİM -->
                <div class="position-relative text-center mb-3">
                    <img id="mainImage"
                         src="@(Model.ImagePaths?.FirstOrDefault() ?? "/images/no-image.png")"
                         class="img-fluid"
                         style="max-height:520px; object-fit:contain;" />

                    <button type="button"
                            class="btn btn-light position-absolute top-50 start-0 translate-middle-y"
                            onclick="prevImage()">
                        ❮
                    </button>

                    <button type="button"
                            class="btn btn-light position-absolute top-50 end-0 translate-middle-y"
                            onclick="nextImage()">
                        ❯
                    </button>
                </div>

                <!-- THUMBNAILS -->
                <div class="d-flex justify-content-center gap-2 flex-wrap">
                    @for (int i = 0; i < Model.ImagePaths.Count; i++)
                    {
                        <img src="@Model.ImagePaths[i]"
                             class="img-thumbnail"
                             style="width:90px;height:90px;object-fit:cover;cursor:pointer"
                             onclick="setImage(@i)" />
                    }
                </div>
            </div>
        </div>

        <!-- SAĞ: ÜRÜN BİLGİLERİ -->
        <div class="col-md-6">
            <div class="bg-white border rounded p-4 h-100">

                <small class="text-muted">Ürün Kodu: <strong>@Model.ProductCode</strong></small>

                <h2 class="mt-2 fw-bold">@Model.ProductName</h2>

                <!-- FİYAT -->
                <div class="my-3">
                    <span class="fs-3 fw-bold text-danger">
                        @Model.UnitPrice.ToString("N2", new System.Globalization.CultureInfo("tr-TR"))
                        @Model.CurrencyCode
                    </span>
                </div>

                <!-- KARGO -->
                <div class="alert alert-success py-2">
                    🚚 <strong>Kargo Ücretsiz</strong>
                </div>

                <!-- ADET + SEPET -->
                <form asp-action="Cart" method="post" class="mt-3">
                    <input type="hidden" asp-for="Id" />

                    <div class="d-flex align-items-end gap-3 mb-3">
                        <div>
       @*                      <label class="form-label">Adet</label>
                            <input asp-for="Quantity"
                                   class="form-control text-end"
                                   style="width:100px" /> *@


                            <div class="mb-2">
                                <label>Adet</label>
                                <input asp-for="Quantity"
                                       type="number"
                                       min="1"
                                       step="1"
                                       class="form-control w-50" />
                                <span asp-validation-for="Quantity" class="text-danger"></span>
                            </div>

                        </div>

                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-cart-plus"></i> Sepete Ekle
                        </button>
                    </div>
                </form>

                <hr />

                <!-- ÜRÜN AÇIKLAMA (HTML DESTEKLİ) -->
                <h5>Ürün Açıklaması</h5>
                <div class="product-description">
                    @Html.Raw(Model.ProductDesc)
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JS -->
<script>
    const images = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.ImagePaths ?? new List<string>()));
    let currentIndex = 0;

    function setImage(index) {
        currentIndex = index;
        document.getElementById("mainImage").src = images[index];
    }

    function prevImage() {
        if (images.length === 0) return;
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        setImage(currentIndex);
    }

    function nextImage() {
        if (images.length === 0) return;
        currentIndex = (currentIndex + 1) % images.length;
        setImage(currentIndex);
    }
</script>
